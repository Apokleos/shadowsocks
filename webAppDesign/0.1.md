# Web应用开发实录产品篇 设计一个文章系统 系统分析以及数据库设计

前台原型图通过甲方的需求之后，就可以交由设计师根据原型图设计效果图了。这时候作为产品，就要更加深层次的思考整个项目的构架了。

产品应该先找技术研发人员开一个小会，基本确定技术选型，某些没有考虑清楚的点可以在这个小会上沟通。

产品与研发人员经过讨论，达成如下意见：

1. 前后端分离开发，接口采用 `restful` 风格。
2. 前端 H5 部分采用 `react` 开发。
3. 前端管理后台部分采用 `vue` 开发，组件采用饿了么的 `element` 进行开发。
4. 后端采用 `python` 开发，基础库是 `sanic`。
5. 后端数据库采用 `sqlite`，为切换数据库类型方便，采用 `sqlalchemy` `ORM` 库进行开发。
6. 服务器选择阿里云的云服务器，操作系统选择 `centos 7` 最新版本部署。
7. `web` 服务使用 `nginx` 部署。

> 事实上，在项目开发中，基本不会出现使用 `sqlite` 数据库的情况的。因为这个数据库相比 `mysql` 或者 `pgsql` 还是有很多的缺陷的。但是我使用 `orm` 库来实现，可以很方便的进行数据库的转移，所以我这边以 `sqlite` 数据库进行开发，毕竟，在开发过程中，会比较方便。
> 另外，一般公司的前端的技术栈是保持一致的，很少一会用 `react`，一会儿选择 `vue` 的。我是为了阐述更多的内容，所以选择不同的前端库来进行实现。

好，大概技术选型确定之后，我们来分析这个需求的数据库构架。

## 系统分析

在甲方看来，其所需要的功能是极其简单的。更多隐藏的需求，甲方并不清楚。只有你把系统做出来了，给甲方看了，甲方才能说出来，这个东西是不是他想要的东西，或者差异在哪里。

事实是，绝大多数甲乙双方在沟通项目的过程中产生的误解，就是因为需求的不明确。而作为一个合格的产品，一定要努力将甲方的真实需求挖掘出来。

> 说个笑话，老板招秘书，有本科生、专科生、硕士生各一名应聘者，通过层层考核，最后选择了胸最大的那个候选者。

上面的笑话其实突出的就是一个问题，甲方的描述，往往不是他的真实需求。

而这个系统的核心点，就是文章的维护，如何将文章更好的，更快的，更便捷的维护出来，才是系统的关键点。

1. 更新文章时，标题、内容以及封面图片的添加是必不可少的动作，在这个动作上进行优化，往往是事倍功半的。
2. 但是作者、来源、关键词等的维护，是可以思考一下，如何降低劳动强度，提高用户体验和录入效率的。

以上两点，经过头脑风暴，已经得出了一些想法，回头在后台原型图中将会提现。

- 根据甲方描述，一级栏目分类就可以满足。但是考虑未来，还是需要做好无限级分类。
- 系统需要一个管理员，管理员可以维护系统的各种配置。
- 当然，系统管理员可以维护所有文章。
- 但我们可以增加一个角色，就是编辑，编辑只有维护文章的权限，客户没有提出来，我们可以做技术储备。
- 系统目前只有文章管理，但未来可能会涉及其他更多内容，比如视频发布等，所以要提现做好构架准备。

经过产品与研发人员一起头脑风暴，我们零零总总的想到了很多的东西，把这些都记下来，然后我们设计数据库。

## 数据库设计

![数据库设计](https://raw.githubusercontent.com/fengcms/articles/master/image/2a/ced4927d9f833671e47b5cb18f9448.jpg)

如上图所示，我们将设计八个表，来支撑我们这套系统。

### site 表

该表的作用是存储系统的基本信息，如 logo 以及版权等。详细如下：

| 字段 | 中文名称 | 描述 |
| :--- | --- |:---|
| id | - | - |
| name | 网站名称 | 用于显示网站的名称 |
| title | 网站标题 | 用于网页 title 显示，比名称长，更利于 SEO |
| keywords | 网站关键词 | 用于网页首页的关键词描述，SEO 考虑 |
| description | 网站描述 | 网站首页描述，SEO 考虑 |
| logo | 网站LOGO | 存放网站 LOGO，可能前端工程师不会使用，预留一个 |
| copyright | 网站版权 | 网站版权信息 |
| time | - | - |

### manages 表

存放管理员的用户名以及密码。

| 字段 | 中文名称 | 描述 |
| :--- | --- |:---|
| id | - | - |
| username | 用户名 | |
| password | 密码 | 密码采用 RSA 加密存储 |
| time | - | - |

管理员支持多名。但没有什么区别，权限都是一样的。

### articles 表

最重要的表了，用于存放所有的文章信息。

| 字段 | 中文名称 | 描述 |
| :--- | --- |:---|
| id | - | - |
| edit_type | 编辑器类型 | 只允许填写两个值 html 或 md ，分辨添加时所用的编辑器类型 |
| title | 文章标题 | |
| channel_id | 归属栏目ID | 用于关联网站所属栏目 |
| description | 文章描述 | 用户搜索引擎优化以及列表中显示导读等 |
| tags | 文章标签 | 搜索引擎 keywords 以及 tags 归类 |
| content | 文章HTML内容 | 存放富文本编辑器编辑的文章内容 |
| markdown | 文章markdown内容 | 存放 md 格式文章内容，自动转成 html 存储到 content 字段 |
| img | 文章封面图片 | |
| author | 文章作者 | |
| origin | 文章来源 | |
| editor | 文章编辑 | |
| time | - | - |

### channel 表

存放网站频道栏目数据。

| 字段 | 中文名称 | 描述 |
| :--- | --- |:---|
| id | - | - |
| name | 栏目名称 | |
| pid | 归属父ID | 顶级栏目为 0，其他为父栏目的ID值 |
| keywords | 栏目关键词 | 用于SEO |
| description | 栏目描述 | 用于SEO |
| time | - | - |

除了正常接口，还需要一个生成树形结构的接口。

### tags 表

存放搜索关键词数据，并且设计可以记录关键词的点击次数。

| 字段 | 中文名称 | 描述 |
| :--- | --- |:---|
| id | - | - |
| tag | 标签 | |
| channel_id | 归属栏目ID | 全局关键词为 0 ,否则是栏目关键词，便于归类和查找|
| hits | 点击数 | 记录点击次数，用于统计热门搜索词|
| time | - | - |

### 其他辅助表

其他作者、来源以及编辑表，都是存放添加文章时所用到的这些信息。其中编辑表有预留用户名以及密码，如果需要的话，可以根据这个数据做一个专门的编辑管理后台，用来管理其对应的所有文章。

> 本文由 FungLeo 原创，未经书面许可，严禁转载。

